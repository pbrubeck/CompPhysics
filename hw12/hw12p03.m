function [] = hw12p03( n )
% Affine transformations
A{1} =[ 0.00000000  0.05300000 -7.08300000; -0.42900000  0.00000000  5.43000000; 0, 0, 1];
A{2} =[ 0.14300000  0.00000000 -5.61900000;  0.00000000 -0.05300000  8.51300000; 0, 0, 1];
A{3} =[ 0.14300000  0.00000000 -5.61900000;  0.00000000  0.08300000  2.05700000; 0, 0, 1];
A{4} =[ 0.00000000  0.05300000 -3.95200000;  0.42900000  0.00000000  5.43000000; 0, 0, 1];
A{5} =[ 0.11900000  0.00000000 -2.55500000;  0.00000000  0.05300000  4.53600000; 0, 0, 1];
A{6} =[-0.01238060 -0.06497230 -1.22600000;  0.42381900  0.00189797  5.23500000; 0, 0, 1];
A{7} =[ 0.08522910  0.05063280 -0.42100000;  0.42044900  0.01566260  4.56900000; 0, 0, 1];
A{8} =[ 0.10443200  0.00529117  0.97600000;  0.05705160  0.05273520  8.11300000; 0, 0, 1];
A{9} =[-0.00814186 -0.04179350  1.93400000;  0.42392200  0.00415972  5.37000000; 0, 0, 1];
A{10}=[ 0.09300000  0.00000000  0.86100000;  0.00000000  0.05300000  4.53600000; 0, 0, 1];
A{11}=[ 0.00000000  0.05300000  2.44700000; -0.42900000  0.00000000  5.43000000; 0, 0, 1];
A{12}=[ 0.11900000  0.00000000  3.36300000;  0.00000000 -0.05300000  8.51300000; 0, 0, 1];
A{13}=[ 0.11900000  0.00000000  3.36300000;  0.00000000  0.05300000  1.48700000; 0, 0, 1];
A{14}=[ 0.00000000  0.05300000  3.97200000;  0.42900000  0.00000000  4.56900000; 0, 0, 1];
A{15}=[ 0.12399800 -0.00183957  6.27500000;  0.00069121  0.06297310  7.71600000; 0, 0, 1];
A{16}=[ 0.00000000  0.05300000  5.21500000;  0.16700000  0.00000000  6.48300000; 0, 0, 1];
A{17}=[ 0.07100000  0.00000000  6.27900000;  0.00000000  0.05300000  5.29800000; 0, 0, 1];
A{18}=[ 0.00000000 -0.05300000  6.80500000; -0.23800000  0.00000000  3.71400000; 0, 0, 1];
A{19}=[-0.12100000  0.00000000  5.94100000;  0.00000000  0.05300000  1.48700000; 0, 0, 1];

% Probability density
m=length(A);
p=ones(m,1)/m;

% Roulette algorithm
[~,kk]=max(bsxfun(@le, rand(1,n-1), cumsum(p)));
x=zeros(3,n);
x(:,1)=[0;0;1];
for i=1:n-1
    x(:,i+1)=A{kk(i)}*x(:,i);
end

scatter(x(1,:), x(2,:), '.r');
daspect([1,1,1]); axis off;
print('hw12p03', '-depsc');
end