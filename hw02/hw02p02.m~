function [E, rbohr] = hw02p02(N, k)
E0=54.4228;  % Electronvolts
r0=0.264589; % Angstroms

[D,t]=chebD(2*N);
[~,w]=ClenshawCurtis(-1, 1, 2*N-1);

t=pi/2*t; D=2/pi*D;
w=r0*w(:);
w=w(1:N);


Dtt=diag(cos(t)).^2*D*diag(sin(t).^2)*D;
Dtt=Dtt(1:N,1:N)+Dtt(1:N,end:-1:N+1);
t=t(1:N);
r=r0*tan(t);

H=-Dtt-diag(tan(t));
B=diag(tan(t).^2);
[S,E]=eig(H(2:end,2:end), B(2:end,2:end));
S=S/diag(sqrt(sum(S.^2)));
[E,order]=sort(diag(E));
E=E0*E(1:k);

Psi=zeros(N,k);
Psi(2:end,:)=S(:,order(1:k));
figure(1);
plot(r, Psi);
xlim([0,20]);

rbohr=Psi(:,1)'*diag(2*r)*Psi(:,1);
end